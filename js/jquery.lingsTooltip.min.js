/* Copyright Elliot Lings 2012 - elliotlings.com/jquery/tooltip
 * This work is licensed under the Creative Commons Attribution-NonCommercial 3.0 Unported License - http://creativecommons.org/licenses/by-nc/3.0/ */
 ;(function($,k,l,m){"use strict";var W=$(l);$.fn.extend({tooltip:function(a,b){a=a||{};if(a&&typeof(a)=='object'){a=$.extend({},$.tooltip.defaults,a)}this.each(function(){new $.tooltip(this,a,b)});return}});$.tooltip=function(f,h,i){var f,h,i,method,methods={open:function(){if(typeof h.onOpen=='function'){h.onOpen.call(this,f,h)}if(h.unique)this.closeAllTooltips();this.bindCloseEvent();if(h.autoPosition)this.position();if(h.ajax&&!h.preload)this.ajaxRequest();h.tooltip.stop(true).fadeTo(h.fade,1,function(){if(typeof h.onOpened=='function'){h.onOpened.call(this,f,h)}})},close:function(){if(typeof h.onClose=='function'){h.onClose.call(this,f,h)}this.bindOpenEvent();h.tooltip.stop(true).fadeTo(h.fade,0,function(){if(typeof h.onClosed=='function'){h.onClosed.call(this,f,h)}})},closeAllTooltips:function(){$($.tooltip.tips).each(function(){var a=$(this).data('tooltip');if(!a.stayOpen)$(this).tooltip('close')})},position:function(a,g,b){h.gravity=g||h.gravity;a=a||false;var c=$(f),anchorX=c.offset().left,anchorY=c.offset().top,anchorW=c.outerWidth(),anchorH=c.outerHeight(),anchorHalfW=anchorW/2;var d=h.tooltip,tooltipW=d.outerWidth(),tooltipH=d.outerHeight(),tooltipHalfW=tooltipW/2;if(h.autoGravity){var e=W.width(),windowHeight=W.height();if((anchorY+anchorH+tooltipH+h.offsetY<windowHeight)&&((tooltipHalfW-anchorHalfW)<=anchorX)){h.gravity='n'}else if((tooltipW+h.offsetX<anchorX)&&(tooltipH/2+anchorY+anchorH/2<windowHeight)){h.gravity='e'}else if((tooltipH+h.offsetY<anchorY)&&(tooltipHalfW-anchorHalfW<=anchorX)){h.gravity='s'}else if((tooltipW+h.offsetX+anchorW+anchorX<e)&&(tooltipH/2+anchorY+anchorH/2<windowHeight)){h.gravity='w'}}if(d.hasClass(h.gravity)&&b)return;d.removeClass('n e w s');d.addClass(h.gravity);if(a){switch(h.gravity){case'n':default:d.stop().animate({'top':anchorY+anchorH+h.offsetY,'left':anchorX+anchorW/2-tooltipHalfW});break;case's':d.stop().animate({'top':anchorY-tooltipH-h.offsetY,'left':anchorX+anchorW/2-tooltipHalfW});break;case'w':d.stop().animate({'top':anchorY+anchorH/2-tooltipH/2,'left':anchorX+anchorW+h.offsetX});break;case'e':d.stop().animate({'top':anchorY+anchorH/2-tooltipH/2,'left':anchorX-tooltipW-h.offsetX});break}}else{switch(h.gravity){case'n':default:d.css({'top':anchorY+anchorH+h.offsetY,'left':anchorX+anchorW/2-tooltipHalfW});break;case's':d.css({'top':anchorY-tooltipH-h.offsetY,'left':anchorX+anchorW/2-tooltipHalfW});break;case'w':d.css({'top':anchorY+anchorH/2-tooltipH/2,'left':anchorX+anchorW+h.offsetX});break;case'e':d.css({'top':anchorY+anchorH/2-tooltipH/2,'left':anchorX-tooltipW-h.offsetX});break}}if(typeof h.onPosition=='function'){h.onPosition.call(this,f,h)}},bindCloseEvent:function(){$(f).off('.lingstip');if(h.closeTrigger){$(f).on((h.closeTrigger+'.lingstip'),function(e){if(h.preventDefault)e.preventDefault();$(f).tooltip('close')})}},bindOpenEvent:function(){$(f).off('.lingstip');if(h.openTrigger){$(f).on((h.openTrigger+'.lingstip'),function(e){if(h.preventDefault)e.preventDefault();$(f).tooltip('open')})}},ajaxRequest:function(c){var d=this;c=c||h.ajax;$.ajax(c).done(function(a){h.content=a;d.updateContent(a)}).fail(function(a,b){h.content=b;d.updateContent(b)});h.preload=true},updateOptions:function(a){$.extend(h,a)},updateContent:function(a){h.tooltip.find('.tooltip-contents').html(a);this.position()},remove:function(){h.tooltip.remove();$(f).removeData(h.closeTrigger+'.lingstip,'+h.openTrigger+'.lingstip');$(f).off(h.closeTrigger)$.tooltip.tips.splice(h.tid,1);$.tooltip.iterator--;return false}};if(h&&typeof(h)=='string'){if(typeof $(f).data('tooltip')=='undefined'){console.log("Cannot apply this method to tooltip. Tooltip doesn't exist.");return}method=h;h=$(f).data('tooltip');methods[method](i);return this}else if(h&&typeof(h)=='object'){if(typeof h.onCreate=='function'){h.onCreate.call(this,f,h)}h.tid=$.tooltip.iterator;$.tooltip.tips[$.tooltip.iterator]=f;if(h.ajax){if(h.preload)methods.ajaxRequest()}var j=$(h.template.replace('{{content}}',h.content)).addClass('.tooltip-'+h.tid,h.classes).attr('id',h.id);if(h.closeButton)j.prepend($(h.closeButtonContents).click(function(e){e.preventDefault();methods.close()}));h.tooltip=j.hide();h.fade=h.fade||0;methods.bindOpenEvent();if(h.autoPosition){$(k).on('resize',function(){$($.tooltip.tips).each(function(){var a=this;if(typeof b=='undefined'){var b=setTimeout(function(){$(a).tooltip('position',false,'',true)},2000)}})})}if(h.wrap)$(f).wrap('<div />').append(h.tooltip);else $('body').append(h.tooltip);methods.position();$.tooltip.iterator++}$(f).data('tooltip',h)};$.tooltip.iterator=0;$.tooltip.tips=[];$.tooltip.reposition=function(a){a=a||false;$($.tooltip.tips).each(function(){$(this).tooltip('position',a)})};$.tooltip.defaults={'content':"Empty",'classes':null,'id':null,'wrap':false,'openTrigger':'click','closeTrigger':'click','preventDefault':true,'closeButton':false,'fade':500,'gravity':'n','autoGravity':true,'autoPosition':true,'unique':true,'stayOpen':false,'offsetY':10,'offsetX':15,'ajax':null,'preload':false,'template':'			<div class="tooltip-container">				<div class="tooltip-contents">{{content}}</div>				<div class="arrow"></div>			</div>','closeButtonContents':'<a href="#" class="tooltip-close">Close</a>','onCreate':function(){},'onOpen':function(){},'onOpened':function(){},'onClose':function(){},'onClosed':function(){},'onPosition':function(){}};$.tooltip.autoTipDefaults={'autoTip':true,'autoTipSelector':'.tip'};$.tooltip.setDefaults=function(a){$.extend($.tooltip.defaults,a)};$.tooltip.autoTip=function(){var d=function(c){$(c).tooltip({'unique':false,'openTrigger':'mouseover','closeTrigger':'mouseout','stayOpen':true,'closeButton':false,'onCreate':function(a,b){b.content=$(a).attr("title");$(a).attr("title",null)}})}$($.tooltip.autoTipDefaults.autoTipSelector).each(function(){d(this)});$($.tooltip.autoTipDefaults.autoTipSelector).live('DOMNodeInserted',function(){if($.tooltip.autoTipDefaults.autoTip)d(this)})}$(l).ready($.tooltip.autoTip)})(jQuery,window,document);